<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Puti Scarf - Order</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="Style.css" />
    <style>
      body {
        background-color: #e4c597;
      }
      .bg-beige {
        background-color: #e4c597 !important;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-beige shadow-sm fixed-top">
      <div class="container">
        <a class="navbar-brand" href="index.html">Puti Scarf</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="produk.html">Products</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="order.html">Order</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <section id="Order" class="py-5">
      <div class="container">
        <div class="row text-center mb-3">
          <div class="col">
            <h2>Order Now</h2>
          </div>
        </div>
        <div class="row justify-content-center">
          <div class="col-md-6">
            <form id="purchaseForm" action="#" method="POST">
              <div class="mb-3">
                <label for="name" class="form-label">Nama</label>
                <input type="text" class="form-control" id="nama" name="nama" required />
              </div>
              <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email" required />
              </div>
              <div class="mb-3">
                <label for="address" class="form-label">Alamat</label>
                <textarea class="form-control" id="alamat" name="alamat" rows="3" required></textarea>
              </div>
              <div class="mb-3">
                <label for="product" class="form-label">Pilih Produk</label>
                <select class="form-select" id="product" name="product" required>
                  <option value="Product 0">Pilih Produk</option>
                  <option value="PJ ~ Hitam">PJ ~ Hitam</option>
                  <option value="PJ ~ Coklat">PJ ~ Coklat</option>
                  <option value="PJ ~ Abu-abu">PJ ~ Abu-abu</option>
                  <option value="PR ~ Hitam">PR ~ Hitam</option>
                  <option value="PR ~ Cream">PR ~ Cream</option>
                  <option value="PR ~ Navy">PR ~ Navy</option>
                  <option value="B ~ Cream">B ~ Cream</option>
                  <option value="B ~ Burgundy">B ~ Burgundy</option>
                  <option value="B ~ Coksu">B ~ Coksu</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="quantity" class="form-label">Quantity</label>
                <input type="number" class="form-control" id="quantity" name="quantity" min="1" required />
              </div>
              <button type="submit" class="btn btn-primary submit-btn">Submit</button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <footer class="bg-beige text-center py-3 style=background-color: #644118; border-color: #644118">
      <p>Created with <i class="bi bi-heart-fill"></i> by Puti Scarf</p>
    </footer>

    <script>
      // URL Google Apps Script (ganti dengan URL Apps Script Anda yang sudah di-deploy)
      const scriptURL = "https://script.google.com/macros/s/AKfycbwqwT6fCC04-V936HIH5hMjI4vA0zCyzsskG2xY1uip90Qg_tow4VMczGMYFJw-2vtyow/exec";

      // Ambil elemen formulir berdasarkan ID
      const form = document.getElementById("purchaseForm");

      // Tambahkan event listener untuk menangani pengiriman formulir
      form.addEventListener("submit", (e) => {
        e.preventDefault(); // Mencegah reload halaman

        // Tampilkan loading state pada tombol submit
        const submitButton = form.querySelector(".submit-btn");
        submitButton.textContent = "Mengirim...";
        submitButton.disabled = true;

        // Kirim data menggunakan Fetch API
        fetch(scriptURL, {
          method: "POST",
          body: new FormData(form),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Gagal mengirim data.");
            }
            alert("Pesanan berhasil dikirim!");
            form.reset(); // Reset formulir setelah berhasil dikirim
            window.location.href = "website.html"; // Redirect ke halaman lain (opsional)
          })
          .catch((error) => {
            alert("Terjadi kesalahan: " + error.message);
          })
          .finally(() => {
            // Kembalikan tombol submit ke state semula
            submitButton.textContent = "Submit";
            submitButton.disabled = false;
          });
      });
    </script>
  </body>
</html>
